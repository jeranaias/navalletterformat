<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Naval Letter Generator | Free SECNAV M-5216.5 Compliant Tool | USMC & Navy</title>

  <!-- SEO Meta Tags -->
  <meta name="description" content="Free online Naval Letter Generator for Marines and Sailors. Creates SECNAV M-5216.5 and MCO 5216.20 compliant correspondence. Instant PDF download, works on NMCI. No installation required.">
  <meta name="keywords" content="naval letter format, SECNAV M-5216.5, Marine Corps correspondence, Navy correspondence, military letter format, naval letter template, USMC letter format, official military correspondence, naval letter generator, military document formatting, Marine Corps letter template, Navy letter template, DON correspondence manual, MCO 5216.20, military admin, S-1, adjutant, correspondence manual, naval message format, military writing, professional military correspondence, Yeoman, admin clerk, military PDF generator, NMCI, government computer, military forms, official letter format, naval correspondence, Marine letter, Navy letter, military letter template free">
  <meta name="author" content="Jesse Morgan">
  <meta name="robots" content="index, follow">
  <link rel="canonical" href="https://jeranaias.github.io/navalletterformat/">

  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://jeranaias.github.io/navalletterformat/">
  <meta property="og:title" content="Naval Letter Generator | Free SECNAV M-5216.5 Tool">
  <meta property="og:description" content="Free online tool for Marines and Sailors. Creates properly formatted naval correspondence. Instant PDF, works on NMCI, no install needed.">
  <meta property="og:site_name" content="Naval Letter Generator">

  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:url" content="https://jeranaias.github.io/navalletterformat/">
  <meta name="twitter:title" content="Naval Letter Generator | Free SECNAV M-5216.5 Tool">
  <meta name="twitter:description" content="Free online tool for Marines and Sailors. Creates properly formatted naval correspondence. Instant PDF, works on NMCI.">

  <!-- Additional SEO -->
  <meta name="application-name" content="Naval Letter Generator">
  <meta name="theme-color" content="#003366">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-title" content="Naval Letter Gen">

  <!-- Structured Data -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebApplication",
    "name": "Naval Letter Generator",
    "description": "Free online tool for creating SECNAV M-5216.5 compliant naval correspondence for the United States Marine Corps and Navy",
    "url": "https://jeranaias.github.io/navalletterformat/",
    "applicationCategory": "BusinessApplication",
    "operatingSystem": "Any",
    "offers": {
      "@type": "Offer",
      "price": "0",
      "priceCurrency": "USD"
    },
    "author": {
      "@type": "Person",
      "name": "Jesse Morgan"
    },
    "keywords": "naval letter, SECNAV M-5216.5, MCO 5216.20, Marine Corps, Navy, military correspondence, USMC, military letter format"
  }
  </script>

  <!-- Styles -->
  <link rel="stylesheet" href="css/styles.css">
  <!-- PWA -->
  <link rel="manifest" href="manifest.json">
  <link rel="apple-touch-icon" href="assets/icon-192.png">
</head>
<body>
  <a href="#letterForm" class="skip-link">Skip to main content</a>

  <!-- Template Modal -->
  <div id="templateModal" class="modal">
    <div class="modal-content template-modal">
      <div class="modal-header">
        <h2>Choose a Template</h2>
        <button type="button" id="templateClose" class="modal-close" aria-label="Close">&times;</button>
      </div>
      <div class="template-filters">
        <input type="text" id="templateSearch" placeholder="Search templates..." class="template-search">
        <select id="categoryFilter" class="category-filter">
          <option value="">All Categories</option>
        </select>
      </div>
      <div id="templateList" class="template-list"></div>
    </div>
  </div>

  <!-- Live Preview Pane -->
  <!-- Batch Generation Modal -->
  <div id="batchModal" class="modal">
    <div class="modal-content batch-modal">
      <div class="modal-header">
        <h2>Batch Generate Letters</h2>
        <button type="button" id="batchModalClose" class="modal-close" aria-label="Close">&times;</button>
      </div>
      <div class="batch-content">
        <div class="batch-guide" style="background: var(--gray-100); padding: 16px; border-radius: var(--radius); margin-bottom: 20px;">
          <h3 style="margin: 0 0 12px 0; font-size: 1rem;">How It Works</h3>
          <ol style="margin: 0; padding-left: 20px; font-size: 0.9rem; line-height: 1.6;">
            <li><strong>Set up your template</strong> - Fill out the form with placeholders like <code>{{name}}</code>, <code>{{rank}}</code>, <code>{{subject}}</code></li>
            <li><strong>Upload CSV</strong> - Each row becomes a letter. Column headers must match your placeholders.</li>
            <li><strong>Generate</strong> - Downloads a ZIP file with all PDFs.</li>
          </ol>
          <p style="margin: 12px 0 0 0; font-size: 0.85rem; color: var(--gray-600);">
            <strong>Available placeholders:</strong> <code>{{name}}</code> <code>{{rank}}</code> <code>{{to}}</code> <code>{{from}}</code> <code>{{subject}}</code> <code>{{date}}</code> <code>{{ssic}}</code> - or any column name from your CSV
          </p>
        </div>
        <div class="batch-actions" style="display: flex; gap: 12px; align-items: center; flex-wrap: wrap;">
          <button type="button" class="btn btn-secondary" onclick="downloadBatchTemplate()">Download Template CSV</button>
          <label for="batchCsvInput" class="btn btn-primary" style="cursor: pointer; margin: 0;">Upload Your CSV</label>
          <input type="file" id="batchCsvInput" accept=".csv" style="display: none;">
          <span id="batchCount" style="color: var(--gray-600);"></span>
        </div>
        <div id="batchPreview" style="display: none; margin-top: 16px; max-height: 250px; overflow: auto;"></div>
        <div style="margin-top: 20px; text-align: right;">
          <button type="button" id="batchGenerateSubmit" class="btn btn-success" disabled>Generate All Letters</button>
        </div>
      </div>
    </div>
  </div>
  <div id="livePreviewPane" class="live-preview-pane">
    <div class="preview-header">
      <span>Live Preview</span>
      <button type="button" class="preview-close" onclick="toggleLivePreview()" aria-label="Close preview">&times;</button>
    </div>
    <div id="previewLoading" class="preview-loading">
      <div class="spinner"></div>
      <span>Generating preview...</span>
    </div>
    <iframe id="previewFrame" class="preview-frame" title="PDF Preview"></iframe>
  </div>

  <div class="container" role="main">
    <header role="banner">
      <div class="header-controls">
        <span id="offlineIndicator" class="offline-indicator" title="Shows if app can work offline. Green = cached and ready, Red = online only">
          <span class="indicator-dot"></span>
          <span class="indicator-text">Loading...</span>
        </span>
        <button type="button" class="theme-toggle" onclick="toggleTheme()" aria-label="Toggle dark mode">
          <span id="themeIcon">â˜€</span>
        </button>
      </div>
      <h1>NAVAL LETTER GENERATOR</h1>
      <p class="subtitle">SECNAV M-5216.5 Compliant Correspondence</p>
    </header>

    <p class="intro-link">
      Free tool for Marines Â· <a href="https://github.com/jeranaias/navalletterformat#readme" target="_blank">Full Guide &amp; Documentation â†’</a>
    </p>

    <!-- Document Import Drop Zone -->
    <div id="docDropZone" class="doc-drop-zone" title="Drop a Word document or click to upload">
      <div class="drop-zone-content">
        <span class="drop-icon">ðŸ“„</span>
        <span class="drop-text">Drop Word doc here or click to import existing letter</span>
      </div>
      <input type="file" id="docFileInput" accept=".docx,.doc,.txt" style="display: none;">
    </div>


    </p>

    <form id="letterForm" role="form" aria-label="Naval letter form">
      <!-- Document Type -->
      <div class="form-section">
        <h2 class="section-title">Document Type</h2>
        <div class="doc-type-selector" role="radiogroup" aria-label="Document type selection">
          <div class="doc-type-option selected" data-type="basic" onclick="selectDocType('basic')" tabindex="0" role="radio" aria-checked="true" onkeydown="if(event.key==='Enter'||event.key===' ')selectDocType('basic')">
            <h3>Basic Letter</h3>
            <p>Standard correspondence format</p>
          </div>
          <div class="doc-type-option" data-type="endorsement" onclick="selectDocType('endorsement')" tabindex="0" role="radio" aria-checked="false" onkeydown="if(event.key==='Enter'||event.key===' ')selectDocType('endorsement')">
            <h3>Endorsement</h3>
            <p>Forward with comments</p>
          </div>
          <div class="doc-type-option" data-type="memorandum" onclick="selectDocType('memorandum')" tabindex="0" role="radio" aria-checked="false" onkeydown="if(event.key==='Enter'||event.key===' ')selectDocType('memorandum')">
            <h3>Memorandum</h3>
            <p>Internal correspondence</p>
          </div>
        </div>

        <!-- Memorandum Style (shown when memorandum selected) -->
        <div id="memorandumFields" style="display: none; margin-top: 16px; text-align: center;">
          <label style="font-weight: 600; margin-bottom: 8px; display: block;">Memorandum Style</label>
          <div class="memo-style-toggle" style="justify-content: center;">
            <div class="memo-option selected" data-formal="false" onclick="selectMemoStyle(false)" tabindex="0" role="radio" aria-checked="true">
              <span class="memo-option-title">Plain Paper</span>
              <span class="memo-option-desc">Internal use</span>
            </div>
            <div class="memo-option" data-formal="true" onclick="selectMemoStyle(true)" tabindex="0" role="radio" aria-checked="false">
              <span class="memo-option-title">Letterhead</span>
              <span class="memo-option-desc">External/formal</span>
            </div>
          </div>
          <input type="hidden" id="formalMemo" value="false">
        </div>

        <!-- Quick Actions Toolbar -->
        <div class="quick-toolbar">
          <button type="button" id="templateBtn" class="btn btn-secondary">Templates</button>
          <button type="button" id="previewToggle" class="btn btn-primary">Live Preview</button>
        </div>
      </div>

      <!-- Basic Info -->
      <div class="form-section">
        <h2 class="section-title">Header Information</h2>
        <div class="form-row">
          <div class="form-group medium">
            <label>SSIC</label>
            <div class="search-container">
              <input type="text" id="ssicSearch" aria-label="SSIC code search" placeholder="Search or enter code..." autocomplete="off">
              <div class="search-results" id="ssicResults"></div>
            </div>
            <p class="help-text">e.g., "leave" or "1050"</p>
          </div>
          <div class="form-group small">
            <label>Office Code</label>
            <input type="text" id="officeCode" aria-label="Office code" placeholder="S-1">
          </div>
          <div class="form-group small">
            <label>Date</label>
            <input type="text" id="date" aria-label="Date" placeholder="Auto-formats">
            <p class="help-text">Any format works</p>
          </div>
          <div class="form-group" style="flex: 0 0 180px;">
            <label>Classification</label>
            <select id="classification" aria-label="Classification level" onchange="togglePortionMarking()">
              <option value="">UNCLASSIFIED</option>
              <option value="CUI">CUI</option>
              <option value="FOUO">FOR OFFICIAL USE ONLY</option>
            </select>
          </div>
          <div class="form-group portion-marking-option" id="portionMarkingOption" style="display: none; flex: 0 0 auto;">
            <label class="checkbox-label" style="margin-top: 24px;">
              <input type="checkbox" id="enablePortionMarking">
              <span>Enable portion marking</span>
            </label>
          </div>
        </div>
      </div>

      <!-- Letterhead -->
      <div class="form-section">
        <h2 class="section-title">Letterhead</h2>
        <div id="letterheadFields">
          <div class="form-row">
            <div class="form-group">
              <label>Find Unit (Optional)</label>
              <div class="search-container">
                <input type="text" id="unitSearch" aria-label="Unit search" placeholder="Search units..." autocomplete="off">
                <div class="search-results" id="unitResults"></div>
              </div>
              <p class="help-text">Search or manually enter below</p>
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label>Service/Organization</label>
              <input type="text" id="unitName" aria-label="Service or organization name" value="UNITED STATES MARINE CORPS">
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label>Unit Name &amp; Address</label>
              <textarea id="unitAddress" aria-label="Unit name and address" rows="3" placeholder="MARINE CORPS DETACHMENT&#10;DEFENSE LANGUAGE INSTITUTE&#10;PRESIDIO OF MONTEREY, CA 93944"></textarea>
            </div>
          </div>
          <p class="help-text" style="margin-top: 12px;">
            <strong>Seal:</strong> The Department of War seal is automatically included on letterhead.
          </p>
        </div>
      </div>

      <!-- Addressing -->
      <div class="form-section">
        <h2 class="section-title">Addressing</h2>
        <div class="form-row">
          <div class="form-group">
            <label>From</label>
            <input type="text" id="from" aria-label="From addressee" placeholder="Commanding Officer, Marine Corps Detachment">
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>To</label>
            <input type="text" id="to" aria-label="To addressee" placeholder="Commandant of the Marine Corps">
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Subject</label>
            <input type="text" id="subj" aria-label="Subject line" placeholder="REQUEST FOR ADDITIONAL PERSONNEL">
            <p class="help-text">Auto-capitalizes</p>
          </div>
        </div>
      </div>

      <!-- Endorsement Fields -->
      <div class="form-section" id="endorsementFields" style="display: none;">
        <h2 class="section-title">Endorsement Details</h2>
        <div class="form-row">
          <div class="form-group small">
            <label>Endorsement</label>
            <select id="endorseNumber">
              <option value="FIRST">FIRST</option>
              <option value="SECOND">SECOND</option>
              <option value="THIRD">THIRD</option>
              <option value="FOURTH">FOURTH</option>
              <option value="FIFTH">FIFTH</option>
            </select>
          </div>
          <div class="form-group">
            <label>Action</label>
            <select id="endorseAction">
              <option value="Forwarded">Forwarded</option>
              <option value="Returned">Returned</option>
              <option value="Forwarded, recommending approval">Forwarded, recommending approval</option>
              <option value="Forwarded, recommending disapproval">Forwarded, recommending disapproval</option>
            </select>
          </div>
        </div>
      </div>

      <!-- Optional Items -->
      <div class="form-section">
        <div class="collapsible-header" onclick="toggleCollapsible(this)">
          <h2 class="section-title" style="margin-bottom: 0;">Via / References / Enclosures</h2>
          <span class="collapsible-icon">â–¼</span>
        </div>
        <div class="collapsible-content">
          <div style="margin-bottom: 20px;">
            <label style="margin-bottom: 10px; display: block;">Via (Chain of Command Routing)</label>
            <div class="dynamic-list" id="viaList"></div>
            <button type="button" class="btn btn-add" onclick="addVia()">+ Add Via</button>
          </div>
          <div style="margin-bottom: 20px;">
            <label style="margin-bottom: 10px; display: block;">References <span style="font-weight: 400; color: var(--gray-500);">â€” auto-letters (a), (b), (c)</span></label>
            <div class="dynamic-list" id="refList"></div>
            <button type="button" class="btn btn-add" onclick="addRef()">+ Add Reference</button>
          </div>
          <div>
            <label style="margin-bottom: 10px; display: block;">Enclosures <span style="font-weight: 400; color: var(--gray-500);">â€” auto-numbers (1), (2), (3)</span></label>
            <div class="dynamic-list" id="enclList"></div>
            <button type="button" class="btn btn-add" onclick="addEncl()">+ Add Enclosure</button>
          </div>
        </div>
      </div>

      <!-- Body Paragraphs -->
      <div class="form-section">
        <div class="section-header-with-actions">
          <h2 class="section-title">Body Paragraphs</h2>
          <div class="undo-redo-buttons">
            <button type="button" id="undoBtn" class="btn btn-icon" onclick="undo()" title="Undo (Ctrl+Z)" disabled>
              <span class="icon-undo">â†¶</span>
            </button>
            <button type="button" id="redoBtn" class="btn btn-icon" onclick="redo()" title="Redo (Ctrl+Y)" disabled>
              <span class="icon-redo">â†·</span>
            </button>
          </div>
          <div class="para-options" style="display: flex; gap: 16px; margin-left: auto;">
            <label class="toggle-label" title="Highlight potential spelling issues" style="display: flex; align-items: center; gap: 4px; font-size: 0.85rem; cursor: pointer;"><input type="checkbox" id="spellCheckToggle"> Spell Check</label>
            <label class="toggle-label" title="Show character and word count" style="display: flex; align-items: center; gap: 4px; font-size: 0.85rem; cursor: pointer;"><input type="checkbox" id="charCountToggle"> Char Count</label>
          </div>
        </div>
        <p class="help-text" style="margin-bottom: 16px;">
          <strong>1.</strong> â†’ <strong>a.</strong> â†’ <strong>(1)</strong> â†’ <strong>(a)</strong> &nbsp;|&nbsp; <strong>+</strong> add below &nbsp;|&nbsp; <strong>â†³</strong> add sub &nbsp;|&nbsp; Drag â˜° to reorder &nbsp;|&nbsp; <strong>Ctrl+Z/Y</strong> undo/redo
        </p>
        <div class="para-container" id="paraContainer"></div>
        <button type="button" class="btn btn-add" onclick="addFirstPara()">+ Add Paragraph</button>
      </div>

      <!-- Signature -->
      <div class="form-section">
        <h2 class="section-title">Signature Block</h2>
        <div class="form-row">
          <div class="form-group">
            <label>Name</label>
            <input type="text" id="sigName" aria-label="Signature name" placeholder="J. M. SMITH">
          </div>
        </div>
        <div class="toggle-group" style="margin-top: 12px;">
          <input type="checkbox" id="byDirection" aria-label="By direction checkbox">
          <label for="byDirection">By direction</label>
        </div>
      </div>

      <!-- Copy To -->
      <div class="form-section">
        <h2 class="section-title">Distribution (Copy To)</h2>
        <div class="dynamic-list" id="copyList"></div>
        <button type="button" class="btn btn-add" onclick="addCopy()">+ Add Recipient</button>
      </div>
    </form>

    <!-- Beta Notice -->
    <div class="info-box warning" style="margin-bottom: 16px;">
      <strong>Beta:</strong> Found a bug? <a href="https://github.com/jeranaias/navalletterformat/issues" target="_blank">Report on GitHub</a>
    </div>

    <!-- Actions -->
    <div class="actions-bar">
      <div class="actions actions-primary">
        <button type="button" class="btn btn-success btn-large" onclick="generatePDF()">Download PDF</button>
        <button type="button" class="btn btn-secondary" onclick="printPDF()">Print</button>
      </div>
      <div class="actions actions-secondary">
        <button type="button" class="btn btn-secondary" onclick="downloadTex()">Download .tex</button>
        <button type="button" class="btn btn-secondary" onclick="downloadZip()">Download ZIP</button>
        <button type="button" class="btn btn-secondary" onclick="exportDraft()">Save Draft</button>
        <button type="button" class="btn btn-secondary" onclick="importDraft()">Load Draft</button>
        <button type="button" class="btn btn-secondary" onclick="exportToWord()">Download Word</button>
        <button type="button" class="btn btn-secondary" onclick="copyAsPlainText()">Copy Text</button>
        <button type="button" id="batchGenerateBtn" class="btn btn-secondary">Batch Generate</button>
      </div>
    </div>

    <!-- Status -->
    <div id="status" class="status"></div>

    <footer role="contentinfo">
      <p><strong>Naval Letter Generator v3.1</strong> Â· SECNAV M-5216.5</p>
      <p>Created by Jesse Morgan Â· Personal project, not officially endorsed</p>
      <p><a href="https://github.com/jeranaias/navalletterformat">GitHub</a> Â· <a href="https://github.com/jeranaias/navalletterformat/issues">Report Issues</a></p>
    </footer>
  </div>

  <!-- External Libraries -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.6.0/mammoth.browser.min.js"></script>
  <script src="https://unpkg.com/docx@8.5.0/build/index.umd.js"></script>

  <!-- Application Scripts -->
  <script src="js/utils.js"></script>
  <script src="js/data-manager.js"></script>
  <script src="js/form-handler.js"></script>
  <script src="js/latex-generator.js"></script>
  <script src="js/pdf-generator.js"></script>
  <script src="js/draft-manager.js"></script>
  <script src="js/preview-manager.js"></script>
  <script src="js/template-manager.js"></script>
  <script src="js/undo-manager.js"></script>
  <script src="js/import-export-manager.js"></script>
  <script src="js/enhanced-features.js"></script>
  <script src="js/batch-generator.js"></script>
  <script src="js/app.js"></script>
</body>
</html>
