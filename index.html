<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Naval Letter Generator | Free SECNAV M-5216.5 Compliant Tool | USMC & Navy</title>

  <!-- SEO Meta Tags -->
  <meta name="description" content="Free online Naval Letter Generator for Marines and Sailors. Creates SECNAV M-5216.5 and MCO 5216.20 compliant correspondence. Instant PDF download, works on NMCI. No installation required.">
  <meta name="keywords" content="naval letter format, SECNAV M-5216.5, Marine Corps correspondence, Navy correspondence, military letter format, naval letter template, USMC letter format, official military correspondence, naval letter generator, military document formatting, Marine Corps letter template, Navy letter template, DON correspondence manual, MCO 5216.20, military admin, S-1, adjutant, correspondence manual, naval message format, military writing, professional military correspondence, Yeoman, admin clerk, military PDF generator, NMCI, government computer, military forms, official letter format, naval correspondence, Marine letter, Navy letter, military letter template free">
  <meta name="author" content="Jesse Morgan">
  <meta name="robots" content="index, follow">
  <link rel="canonical" href="https://jeranaias.github.io/navalletterformat/">

  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://jeranaias.github.io/navalletterformat/">
  <meta property="og:title" content="Naval Letter Generator | Free SECNAV M-5216.5 Tool">
  <meta property="og:description" content="Free online tool for Marines and Sailors. Creates properly formatted naval correspondence. Instant PDF, works on NMCI, no install needed.">
  <meta property="og:site_name" content="Naval Letter Generator">

  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:url" content="https://jeranaias.github.io/navalletterformat/">
  <meta name="twitter:title" content="Naval Letter Generator | Free SECNAV M-5216.5 Tool">
  <meta name="twitter:description" content="Free online tool for Marines and Sailors. Creates properly formatted naval correspondence. Instant PDF, works on NMCI.">

  <!-- Additional SEO -->
  <meta name="application-name" content="Naval Letter Generator">
  <meta name="theme-color" content="#003366">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-title" content="Naval Letter Gen">

  <!-- Structured Data - WebApplication -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebApplication",
    "name": "Naval Letter Generator",
    "alternateName": ["Naval Letter Format", "Military Letter Generator", "USMC Letter Generator"],
    "description": "Free online tool for creating SECNAV M-5216.5 compliant naval correspondence for the United States Marine Corps and Navy",
    "url": "https://jeranaias.github.io/navalletterformat/",
    "applicationCategory": "BusinessApplication",
    "operatingSystem": "Any",
    "browserRequirements": "Requires JavaScript. Works on NMCI and government computers.",
    "softwareVersion": "3.1.1",
    "datePublished": "2024-12-12",
    "dateModified": "2024-12-16",
    "inLanguage": "en-US",
    "isAccessibleForFree": true,
    "offers": {
      "@type": "Offer",
      "price": "0",
      "priceCurrency": "USD",
      "availability": "https://schema.org/InStock"
    },
    "author": {
      "@type": "Person",
      "name": "Jesse Morgan"
    },
    "publisher": {
      "@type": "Organization",
      "name": "Naval Letter Generator"
    },
    "audience": {
      "@type": "Audience",
      "audienceType": "Military Personnel",
      "geographicArea": {
        "@type": "Country",
        "name": "United States"
      }
    },
    "featureList": [
      "SECNAV M-5216.5 compliant formatting",
      "MCO 5216.20 compliant formatting",
      "Instant PDF generation",
      "Works on NMCI computers",
      "38 pre-built templates",
      "100+ searchable references",
      "Live preview",
      "Dark mode",
      "No installation required"
    ],
    "screenshot": "https://jeranaias.github.io/navalletterformat/assets/screenshot.png",
    "keywords": "naval letter, SECNAV M-5216.5, MCO 5216.20, Marine Corps, Navy, military correspondence, USMC, military letter format, naval letter format, military letter template"
  }
  </script>

  <!-- Structured Data - FAQ for Rich Results -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "FAQPage",
    "mainEntity": [
      {
        "@type": "Question",
        "name": "What is the proper naval letter format?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "The proper naval letter format is defined by SECNAV M-5216.5 (Department of the Navy Correspondence Manual). It includes a letterhead, SSIC code, date, From/To/Via lines, Subject, References, Enclosures, numbered paragraphs, and a signature block. The Naval Letter Generator automatically formats all these elements correctly."
        }
      },
      {
        "@type": "Question",
        "name": "Does the Naval Letter Generator work on NMCI computers?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Yes, the Naval Letter Generator works on NMCI (Navy Marine Corps Intranet) computers. It runs entirely in your web browser with no installation required and no data is sent to external servers. It's 100% client-side JavaScript."
        }
      },
      {
        "@type": "Question",
        "name": "What is an SSIC code?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "SSIC stands for Standard Subject Identification Code. It's a 4-5 digit number that categorizes naval correspondence by subject matter (e.g., 1000 for Military Personnel, 5216 for Correspondence Management). The Naval Letter Generator includes a searchable database of all SSIC codes."
        }
      },
      {
        "@type": "Question",
        "name": "Is the Naval Letter Generator free?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Yes, the Naval Letter Generator is completely free with no registration required. It was built by Marines for Marines and Sailors to make correspondence easier."
        }
      },
      {
        "@type": "Question",
        "name": "What military letter templates are available?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "The Naval Letter Generator includes 38 pre-built templates including: Leave Request, Special Liberty, Request Mast, Page 11 Entry, NAM Recommendation, Letter of Appreciation, 6105 Counseling, Meritorious Promotion, and many more. All templates follow SECNAV M-5216.5 formatting."
        }
      }
    ]
  }
  </script>

  <!-- Structured Data - HowTo for Rich Results -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "HowTo",
    "name": "How to Write a Naval Letter",
    "description": "Step-by-step guide to creating a properly formatted naval letter using the Naval Letter Generator",
    "totalTime": "PT5M",
    "tool": {
      "@type": "HowToTool",
      "name": "Naval Letter Generator"
    },
    "step": [
      {
        "@type": "HowToStep",
        "name": "Select Document Type",
        "text": "Choose between Basic Letter, Endorsement, or Memorandum format"
      },
      {
        "@type": "HowToStep",
        "name": "Enter Header Information",
        "text": "Add your SSIC code, office code, and date. The generator will format these correctly."
      },
      {
        "@type": "HowToStep",
        "name": "Fill in Addressees",
        "text": "Enter the From, To, and Via (if applicable) addressee information"
      },
      {
        "@type": "HowToStep",
        "name": "Add Subject and References",
        "text": "Write your subject line and add any references or enclosures"
      },
      {
        "@type": "HowToStep",
        "name": "Write Body Paragraphs",
        "text": "Add your letter content. Use the + button for additional paragraphs and sub-paragraphs."
      },
      {
        "@type": "HowToStep",
        "name": "Download PDF",
        "text": "Click Download PDF to generate your properly formatted naval letter"
      }
    ]
  }
  </script>

  <!-- Structured Data - Organization -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Organization",
    "name": "Naval Letter Generator",
    "url": "https://jeranaias.github.io/navalletterformat/",
    "logo": "https://jeranaias.github.io/navalletterformat/assets/icon-512.png",
    "sameAs": [
      "https://github.com/jeranaias/navalletterformat"
    ]
  }
  </script>

  <!-- Styles -->
  <link rel="stylesheet" href="css/styles.css">
  <!-- PWA -->
  <link rel="manifest" href="manifest.json">
  <link rel="apple-touch-icon" href="assets/icon-192.png">
</head>
<body>
  <a href="#letterForm" class="skip-link">Skip to main content</a>

  <!-- Template Modal -->
  <div id="templateModal" class="modal">
    <div class="modal-content template-modal template-modal-wide">
      <div class="modal-header">
        <h2>Choose a Template</h2>
        <button type="button" id="templateClose" class="modal-close" aria-label="Close">&times;</button>
      </div>
      <div class="template-body">
        <div class="template-list-pane">
          <div class="template-filters">
            <input type="text" id="templateSearch" placeholder="Search templates..." class="template-search" aria-label="Search templates">
            <select id="categoryFilter" class="category-filter" aria-label="Filter by category">
              <option value="">All Categories</option>
            </select>
          </div>
          <div id="templateList" class="template-list"></div>
        </div>
        <div class="template-preview-pane" id="templatePreviewPane">
          <div class="template-preview-empty">
            <p>Select a template to preview</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Reference Library Modal -->
  <div id="refLibraryModal" class="modal">
    <div class="modal-content ref-library-modal">
      <div class="modal-header">
        <h2>Reference Library</h2>
        <button type="button" class="modal-close" onclick="closeReferenceLibrary()" aria-label="Close">&times;</button>
      </div>
      <div class="ref-library-content">
        <div class="ref-search-box">
          <input type="text" id="refLibrarySearch" placeholder="Search MCOs, SECNAVINSTs, topics..." aria-label="Search references">
        </div>
        <div id="refLibraryResults" class="ref-library-results">
          <!-- Results populated by JS -->
        </div>
      </div>
    </div>
  </div>

  <!-- User Profile Modal -->
  <div id="profileModal" class="modal">
    <div class="modal-content profile-modal">
      <div class="modal-header">
        <h2>My Profile</h2>
        <button type="button" class="modal-close" onclick="closeProfileModal()" aria-label="Close">&times;</button>
      </div>
      <div class="profile-content">
        <div class="profile-disclaimer">
          <strong>Data Security Notice:</strong> Profile data is stored in your browser's session only and is automatically cleared when you close the browser. No data is stored permanently on this computer or transmitted anywhere. Use "Export to File" to save your profile to your personal storage device.
        </div>

        <div class="profile-file-actions">
          <button type="button" class="btn btn-secondary" onclick="importProfileFromFile()">Load from File</button>
          <button type="button" class="btn btn-secondary" onclick="exportProfileToFile()">Export to File</button>
        </div>

        <div class="profile-section">
          <h3>Personal Information</h3>
          <div class="form-row">
            <div class="form-group">
              <label>Signature Name</label>
              <input type="text" id="profileName" placeholder="J. M. SMITH" aria-label="Signature name">
              <p class="help-text">How your name appears in signature block</p>
            </div>
          </div>
          <div class="form-row">
            <div class="form-group small">
              <label>Rank</label>
              <input type="text" id="profileRank" placeholder="Capt" aria-label="Rank">
            </div>
            <div class="form-group">
              <label>Billet/Title</label>
              <input type="text" id="profileBillet" placeholder="Commanding Officer" aria-label="Billet or title">
            </div>
          </div>
        </div>

        <div class="profile-section">
          <h3>Unit Information</h3>
          <div class="form-row">
            <div class="form-group">
              <label>Service/Organization</label>
              <input type="text" id="profileUnitService" value="UNITED STATES MARINE CORPS" aria-label="Service or organization">
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label>Unit Name</label>
              <input type="text" id="profileUnitName" placeholder="MARINE CORPS DETACHMENT" aria-label="Unit name">
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label>Unit Address</label>
              <textarea id="profileUnitAddress" rows="2" placeholder="DEFENSE LANGUAGE INSTITUTE&#10;PRESIDIO OF MONTEREY, CA 93944" aria-label="Unit address"></textarea>
            </div>
          </div>
        </div>

        <div class="profile-section">
          <h3>Default From Line</h3>
          <div class="form-row">
            <div class="form-group">
              <label>From</label>
              <input type="text" id="profileFromLine" placeholder="Commanding Officer, Marine Corps Detachment" aria-label="Default from line">
              <p class="help-text">Auto-generates from Billet + Unit, or customize</p>
            </div>
          </div>
        </div>

        <div class="profile-section">
          <h3>Contact &amp; Preferences</h3>
          <div class="form-row">
            <div class="form-group small">
              <label>Office Code</label>
              <input type="text" id="profileOfficeCode" placeholder="S-1" aria-label="Default office code">
            </div>
            <div class="form-group small">
              <label>Phone</label>
              <input type="text" id="profilePhone" placeholder="DSN 555-1234" aria-label="Phone number">
            </div>
            <div class="form-group">
              <label>Email</label>
              <input type="text" id="profileEmail" placeholder="john.smith@usmc.mil" aria-label="Email address">
            </div>
          </div>
          <div class="toggle-group" style="margin-top: 12px;">
            <input type="checkbox" id="profileByDirection" aria-label="Default by direction">
            <label for="profileByDirection">Default to "By direction"</label>
          </div>
        </div>

        <div class="profile-actions">
          <button type="button" class="btn btn-success" onclick="saveProfileFromModal()">Apply to Session</button>
          <button type="button" class="btn btn-secondary" onclick="captureFormToProfile()">Capture from Form</button>
          <button type="button" class="btn btn-danger-outline" onclick="if(confirm('Clear profile from this session?')){clearUserProfile();closeProfileModal();}">Clear Session</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Live Preview Pane -->
  <!-- Batch Generation Modal -->
  <div id="batchModal" class="modal">
    <div class="modal-content batch-modal batch-modal-wide">
      <div class="modal-header">
        <h2>Batch Generate Letters</h2>
        <button type="button" id="batchModalClose" class="modal-close" aria-label="Close">&times;</button>
      </div>
      <div class="batch-content">
        <div class="batch-guide">
          <div class="batch-guide-header">
            <h3>How It Works</h3>
            <button type="button" class="batch-help-btn" onclick="showBatchHelp()" title="Full explanation with examples">?</button>
          </div>
          <p>Your current letter is the template. Add recipients below - each row generates a separate letter.</p>
          <div class="batch-options">
            <label class="batch-option" title="Use for awards, counseling, notifications - you sign all letters">
              <input type="checkbox" id="batchKeepSignature" checked>
              <span>Keep my signature</span>
            </label>
            <label class="batch-option" title="Use for leave requests - each person signs their own letter">
              <input type="checkbox" id="batchNameIsSignature">
              <span>Name = Signature</span>
            </label>
          </div>
        </div>

        <!-- Editable Table Section -->
        <div class="batch-table-section">
          <div class="batch-table-header">
            <h3>Recipients <span id="batchCount" class="batch-count-badge"></span></h3>
            <div class="batch-table-actions">
              <button type="button" class="btn btn-sm btn-primary" onclick="addBatchRow()">+ Add Row</button>
              <label for="batchCsvInput" class="btn btn-sm btn-secondary" style="cursor: pointer; margin: 0;">Import CSV</label>
              <input type="file" id="batchCsvInput" accept=".csv" style="display: none;">
              <button type="button" class="btn btn-sm btn-secondary" onclick="downloadBatchTemplate()" title="Download a sample CSV template">Template</button>
              <button type="button" class="btn btn-sm btn-danger-outline" onclick="clearBatchTable()" title="Clear all rows">Clear</button>
            </div>
          </div>
          <div id="batchTableEditor" class="batch-table-editor">
            <!-- Editable table renders here -->
          </div>
        </div>

        <div class="batch-placeholders-hint">
          <strong>Auto-mapped:</strong> To &rarr; To line, Subject &rarr; Subject, Date &rarr; Date, SSIC &rarr; SSIC<br>
          <strong>In paragraphs:</strong> Use <code>{{name}}</code>, <code>{{rank}}</code>, <code>{{reason}}</code>, <code>{{period}}</code> to insert values mid-sentence
        </div>

        <div class="batch-footer">
          <button type="button" id="batchGenerateSubmit" class="btn btn-success btn-lg" disabled>Generate All Letters</button>
        </div>
      </div>
    </div>
  </div>
  <div id="livePreviewPane" class="live-preview-pane">
    <div class="preview-header">
      <span>Live Preview</span>
      <button type="button" class="preview-close" onclick="toggleLivePreview()" aria-label="Close preview">&times;</button>
    </div>
    <div id="previewLoading" class="preview-loading">
      <div class="spinner"></div>
      <span>Generating preview...</span>
    </div>
    <iframe id="previewFrame" class="preview-frame" title="PDF Preview"></iframe>
  </div>

  <div class="container" role="main">
    <header role="banner">
      <div class="header-profile">
        <button type="button" class="btn btn-profile" onclick="openProfileModal()" title="Save your info for auto-fill">
          <span class="profile-icon">ðŸ‘¤</span>
          <span class="profile-text">My Profile</span>
        </button>
      </div>
      <div class="header-controls">
        <span id="offlineIndicator" class="offline-indicator" title="Shows if app can work offline. Green = cached and ready, Red = online only">
          <span class="indicator-dot"></span>
          <span class="indicator-text">Loading...</span>
        </span>
        <button type="button" class="theme-toggle" onclick="toggleTheme()" aria-label="Toggle dark mode">
          <span id="themeIcon">â˜€</span>
        </button>
      </div>
      <h1>NAVAL LETTER GENERATOR</h1>
      <p class="subtitle">SECNAV M-5216.5 Compliant Correspondence</p>
    </header>

    <p class="intro-link">
      Free tool for Marines Â· <a href="https://github.com/jeranaias/navalletterformat#readme" target="_blank">Full Guide &amp; Documentation â†’</a>
    </p>

    <!-- Document Import Drop Zone -->
    <div id="docDropZone" class="doc-drop-zone" title="Drop a Word document or click to upload">
      <div class="drop-zone-content">
        <span class="drop-icon">ðŸ“„</span>
        <span class="drop-text">Drop Word doc here or click to import existing letter</span>
      </div>
      <input type="file" id="docFileInput" accept=".docx,.doc,.txt" style="display: none;">
    </div>


    </p>

    <!-- Layout Warning Banner -->
    <div id="layoutWarning" class="layout-warning" style="display: none;" role="alert">
      <div class="layout-warning-content">
        <span class="layout-warning-icon">&#9888;</span>
        <div class="layout-warning-text">
          <strong>Layout Notice:</strong>
          <span id="layoutWarningMessage"></span>
        </div>
        <button type="button" class="layout-warning-dismiss" onclick="dismissLayoutWarning()" aria-label="Dismiss">&times;</button>
      </div>
    </div>

    <form id="letterForm" role="form" aria-label="Naval letter form">
      <!-- Document Type -->
      <div class="form-section">
        <h2 class="section-title">Document Type</h2>
        <div class="doc-type-selector" role="radiogroup" aria-label="Document type selection">
          <div class="doc-type-option selected" data-type="basic" onclick="selectDocType('basic')" tabindex="0" role="radio" aria-checked="true" onkeydown="if(event.key==='Enter'||event.key===' ')selectDocType('basic')">
            <h3>Basic Letter</h3>
            <p>Standard correspondence format</p>
          </div>
          <div class="doc-type-option" data-type="endorsement" onclick="selectDocType('endorsement')" tabindex="0" role="radio" aria-checked="false" onkeydown="if(event.key==='Enter'||event.key===' ')selectDocType('endorsement')">
            <h3>Endorsement</h3>
            <p>Forward with comments</p>
          </div>
          <div class="doc-type-option" data-type="memorandum" onclick="selectDocType('memorandum')" tabindex="0" role="radio" aria-checked="false" onkeydown="if(event.key==='Enter'||event.key===' ')selectDocType('memorandum')">
            <h3>Memorandum</h3>
            <p>Internal correspondence</p>
          </div>
        </div>

        <!-- Memorandum Style (shown when memorandum selected) -->
        <div id="memorandumFields" style="display: none; margin-top: 16px; text-align: center;">
          <label style="font-weight: 600; margin-bottom: 8px; display: block;">Memorandum Style</label>
          <div class="memo-style-toggle" style="justify-content: center;">
            <div class="memo-option selected" data-formal="false" onclick="selectMemoStyle(false)" tabindex="0" role="radio" aria-checked="true">
              <span class="memo-option-title">Plain Paper</span>
              <span class="memo-option-desc">Internal use</span>
            </div>
            <div class="memo-option" data-formal="true" onclick="selectMemoStyle(true)" tabindex="0" role="radio" aria-checked="false">
              <span class="memo-option-title">Letterhead</span>
              <span class="memo-option-desc">External/formal</span>
            </div>
          </div>
          <input type="hidden" id="formalMemo" value="false">
        </div>

        <!-- Quick Actions Toolbar -->
        <div class="quick-toolbar">
          <button type="button" id="templateBtn" class="btn btn-secondary">Templates</button>
          <button type="button" id="previewToggle" class="btn btn-primary">Live Preview</button>
        </div>
      </div>

      <!-- Basic Info -->
      <div class="form-section">
        <h2 class="section-title">Header Information</h2>
        <div class="form-row header-info-row">
          <div class="form-group">
            <label>SSIC</label>
            <div class="search-container">
              <input type="text" id="ssicSearch" aria-label="SSIC code search" placeholder="1050" autocomplete="off" title="Search by keyword (e.g., 'leave') or enter code directly">
              <div class="search-results" id="ssicResults"></div>
            </div>
          </div>
          <div class="form-group">
            <label>Office Code</label>
            <div class="search-container">
              <input type="text" id="officeCode" aria-label="Office code search" placeholder="S-1" autocomplete="off" title="Search by code or title (e.g., S-1, Personnel, Operations)">
              <div class="search-results" id="officeCodeResults"></div>
            </div>
          </div>
          <div class="form-group">
            <label>Date</label>
            <input type="text" id="date" aria-label="Date" placeholder="Auto-formats" title="Enter any format - auto-converts to military format">
          </div>
          <div class="form-group">
            <label>Classification</label>
            <select id="classification" aria-label="Classification level" onchange="togglePortionMarking()" title="Document classification level">
              <option value="">UNCLASSIFIED</option>
              <option value="CUI">CUI</option>
              <option value="FOUO">FOR OFFICIAL USE ONLY</option>
            </select>
          </div>
        </div>
        <div class="toggle-group" style="margin-top: 12px;">
          <input type="checkbox" id="showInReplyTo" aria-label="Show IN REPLY REFER TO">
          <label for="showInReplyTo">Include "IN REPLY REFER TO:" above SSIC <span style="font-weight: 400; color: var(--gray-500);">â€” use if not pre-printed on letterhead</span></label>
        </div>
      </div>

      <!-- Letterhead -->
      <div class="form-section">
        <h2 class="section-title">Letterhead</h2>
        <div id="letterheadFields">
          <div class="form-row">
            <div class="form-group">
              <label>Find Unit (Optional)</label>
              <div class="search-container">
                <input type="text" id="unitSearch" aria-label="Unit search" placeholder="Search units..." autocomplete="off">
                <div class="search-results" id="unitResults"></div>
              </div>
              <p class="help-text">Search or manually enter below</p>
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label>Service/Organization</label>
              <input type="text" id="unitName" aria-label="Service or organization name" value="UNITED STATES MARINE CORPS">
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label>Unit Name &amp; Address</label>
              <textarea id="unitAddress" aria-label="Unit name and address" rows="3" placeholder="MARINE CORPS DETACHMENT&#10;DEFENSE LANGUAGE INSTITUTE&#10;PRESIDIO OF MONTEREY, CA 93944"></textarea>
            </div>
          </div>
          <p class="help-text" style="margin-top: 12px;">
            <strong>Seal:</strong> The Department of War seal is automatically included on letterhead.
          </p>
        </div>
      </div>

      <!-- Addressing -->
      <div class="form-section">
        <h2 class="section-title">Addressing</h2>
        <div class="form-row">
          <div class="form-group">
            <label>From</label>
            <input type="text" id="from" aria-label="From addressee" placeholder="Commanding Officer, Marine Corps Detachment">
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>To</label>
            <input type="text" id="to" aria-label="To addressee" placeholder="Commandant of the Marine Corps">
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Subject <span id="subjCharCount" class="char-count">0/100</span></label>
            <input type="text" id="subj" aria-label="Subject line" placeholder="REQUEST FOR ADDITIONAL PERSONNEL">
            <p class="help-text">Auto-capitalizes Â· Keep under 100 chars</p>
          </div>
        </div>
      </div>

      <!-- Endorsement Fields -->
      <div class="form-section" id="endorsementFields" style="display: none;">
        <h2 class="section-title">Endorsement Details</h2>
        <div class="form-row">
          <div class="form-group small">
            <label>Endorsement</label>
            <select id="endorseNumber">
              <option value="FIRST">FIRST</option>
              <option value="SECOND">SECOND</option>
              <option value="THIRD">THIRD</option>
              <option value="FOURTH">FOURTH</option>
              <option value="FIFTH">FIFTH</option>
            </select>
          </div>
          <div class="form-group">
            <label>Action</label>
            <select id="endorseAction">
              <option value="Forwarded">Forwarded</option>
              <option value="Returned">Returned</option>
              <option value="Forwarded, recommending approval">Forwarded, recommending approval</option>
              <option value="Forwarded, recommending disapproval">Forwarded, recommending disapproval</option>
            </select>
          </div>
        </div>
      </div>

      <!-- Optional Items -->
      <div class="form-section">
        <div class="collapsible-header" onclick="toggleCollapsible(this)">
          <h2 class="section-title" style="margin-bottom: 0;">Via / References / Enclosures</h2>
          <span class="collapsible-icon">â–¼</span>
        </div>
        <div class="collapsible-content">
          <div style="margin-bottom: 20px;">
            <label style="margin-bottom: 10px; display: block;">Via (Chain of Command Routing)</label>
            <div class="dynamic-list" id="viaList"></div>
            <button type="button" class="btn btn-add" onclick="addVia()">+ Add Via</button>
          </div>
          <div style="margin-bottom: 20px;">
            <label style="margin-bottom: 10px; display: block;">References <span style="font-weight: 400; color: var(--gray-500);">â€” auto-letters (a), (b), (c)</span></label>
            <div class="dynamic-list" id="refList"></div>
            <div class="ref-buttons">
              <button type="button" class="btn btn-add" onclick="addRef()">+ Add Reference</button>
              <button type="button" class="btn btn-secondary btn-library" onclick="openReferenceLibrary()">ðŸ“š Browse Library</button>
            </div>
          </div>
          <div>
            <label style="margin-bottom: 10px; display: block;">Enclosures <span style="font-weight: 400; color: var(--gray-500);">â€” auto-numbers (1), (2), (3)</span></label>
            <div class="dynamic-list" id="enclList"></div>
            <button type="button" class="btn btn-add" onclick="addEncl()">+ Add Enclosure</button>
          </div>
        </div>
      </div>

      <!-- Body Paragraphs -->
      <div class="form-section">
        <div class="section-header-with-actions">
          <h2 class="section-title">Body Paragraphs</h2>
          <div class="undo-redo-buttons">
            <button type="button" id="findReplaceBtn" class="btn btn-icon" onclick="toggleFindReplace()" title="Find & Replace (Ctrl+H)">
              <span class="icon-search">âŒ•</span>
            </button>
            <button type="button" id="undoBtn" class="btn btn-icon" onclick="undo()" title="Undo (Ctrl+Z)" disabled>
              <span class="icon-undo">â†¶</span>
            </button>
            <button type="button" id="redoBtn" class="btn btn-icon" onclick="redo()" title="Redo (Ctrl+Y)" disabled>
              <span class="icon-redo">â†·</span>
            </button>
          </div>
        </div>

        <!-- Find & Replace Panel (floating) -->
        <div id="findReplacePanel" class="find-replace-panel" style="display: none;">
          <div class="find-replace-header">
            <span class="find-replace-title">Find & Replace</span>
            <button type="button" class="find-replace-close" onclick="toggleFindReplace()" title="Close (Esc)">&times;</button>
          </div>
          <div class="find-replace-row">
            <div class="find-replace-field">
              <label for="findInput">Find:</label>
              <input type="text" id="findInput" placeholder="Text to find" aria-label="Find text">
            </div>
            <div class="find-replace-field">
              <label for="replaceInput">Replace:</label>
              <input type="text" id="replaceInput" placeholder="Replace with" aria-label="Replace text">
            </div>
            <div class="find-replace-actions">
              <button type="button" class="btn btn-sm" onclick="findNext()" title="Find Next (Enter or F3)">Find Next</button>
              <button type="button" class="btn btn-sm" onclick="replaceNext()">Replace</button>
              <button type="button" class="btn btn-sm" onclick="replaceAll()">Replace All</button>
            </div>
          </div>
          <div class="find-replace-options">
            <label class="checkbox-label">
              <input type="checkbox" id="findCaseSensitive">
              Case sensitive
            </label>
            <span id="findResultStatus" class="find-result-status"></span>
            <span class="find-replace-hint">Enter or F3 = Next &nbsp;|&nbsp; Esc = Close</span>
          </div>
        </div>

        <p class="help-text" style="margin-bottom: 16px;">
          <strong>Ctrl+B/I/U</strong> format &nbsp;|&nbsp; <strong>Ctrl+H</strong> find/replace &nbsp;|&nbsp; <strong>+</strong> add below &nbsp;|&nbsp; <strong>â†³</strong> add sub &nbsp;|&nbsp; Drag â˜° to reorder
        </p>
        <div class="para-container" id="paraContainer"></div>
        <button type="button" class="btn btn-add" onclick="addFirstPara()">+ Add Paragraph</button>
      </div>

      <!-- Signature -->
      <div class="form-section">
        <h2 class="section-title">Signature Block</h2>
        <div class="form-row">
          <div class="form-group">
            <label>Name</label>
            <input type="text" id="sigName" aria-label="Signature name" placeholder="J. M. SMITH">
          </div>
        </div>
        <div class="toggle-group" style="margin-top: 12px;">
          <input type="checkbox" id="byDirection" aria-label="By direction checkbox">
          <label for="byDirection">By direction</label>
        </div>
      </div>

      <!-- Copy To -->
      <div class="form-section">
        <h2 class="section-title">Distribution (Copy To)</h2>
        <div class="dynamic-list" id="copyList"></div>
        <button type="button" class="btn btn-add" onclick="addCopy()">+ Add Recipient</button>
      </div>
    </form>

    <!-- Beta Notice -->
    <div class="info-box warning" style="margin-bottom: 16px;">
      <strong>Beta:</strong> Found a bug? <a href="https://github.com/jeranaias/navalletterformat/issues" target="_blank">Report on GitHub</a>
    </div>

    <!-- Actions -->
    <div class="actions-bar">
      <div class="actions actions-primary">
        <button type="button" class="btn btn-success btn-large" onclick="generatePDFSafe()">Download PDF</button>
        <button type="button" class="btn btn-secondary" onclick="printPDF()">Print</button>
      </div>
      <div class="actions actions-secondary">
        <button type="button" class="btn btn-secondary" onclick="downloadTex()">Download .tex</button>
        <button type="button" class="btn btn-secondary" onclick="downloadZip()">Download ZIP</button>
        <button type="button" class="btn btn-secondary" onclick="exportDraft()">Save Draft</button>
        <button type="button" class="btn btn-secondary" onclick="importDraft()">Load Draft</button>
        <button type="button" class="btn btn-secondary" onclick="duplicateLetter()">Duplicate</button>
        <button type="button" class="btn btn-secondary" onclick="exportToWord()">Download Word</button>
        <button type="button" class="btn btn-secondary" onclick="copyAsPlainText()">Copy Text</button>
        <button type="button" id="batchGenerateBtn" class="btn btn-secondary">Batch Generate</button>
      </div>
    </div>

    <!-- Recent Drafts (Session Only) -->
    <div class="recent-drafts-section">
      <h3 class="recent-drafts-title">Recent Drafts (This Session)</h3>
      <div id="recentDraftsContainer">
        <p class="recent-drafts-empty">No recent drafts in this session</p>
      </div>
    </div>

    <!-- Status -->
    <div id="status" class="status"></div>

    <footer role="contentinfo">
      <p><strong>Naval Letter Generator v3.1</strong> Â· SECNAV M-5216.5</p>
      <p>Created by Jesse Morgan Â· Personal project, not officially endorsed</p>
      <p><a href="https://github.com/jeranaias/navalletterformat">GitHub</a> Â· <a href="https://github.com/jeranaias/navalletterformat/issues">Report Issues</a> Â· <a href="#" onclick="showTipsAgain();return false;">Show Tips</a></p>
    </footer>
  </div>

  <!-- Bundled Libraries (offline support) -->
  <script src="lib/jszip.min.js"></script>
  <script src="lib/jspdf.umd.min.js"></script>
  <script src="lib/mammoth.browser.min.js"></script>
  <script src="lib/docx.umd.min.js"></script>

  <!-- Application Scripts -->
  <script src="js/utils.js"></script>
  <script src="js/data-manager.js"></script>
  <script src="js/form-handler.js"></script>
  <script src="js/latex-generator.js"></script>
  <script src="js/pdf-generator.js"></script>
  <script src="js/draft-manager.js"></script>
  <script src="js/preview-manager.js"></script>
  <script src="js/template-manager.js"></script>
  <script src="js/undo-manager.js"></script>
  <script src="js/import-export-manager.js"></script>
  <script src="js/enhanced-features.js"></script>
  <script src="js/batch-generator.js"></script>
  <script src="js/user-profile.js"></script>
  <script src="js/reference-library.js"></script>
  <script src="js/validation.js"></script>
  <script src="js/enhancements.js"></script>
  <script src="js/welcome.js"></script>
  <script src="js/app.js"></script>
</body>
</html>
